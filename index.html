<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WaveForce - YouTube to WAV Converter</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: radial-gradient(ellipse at center, #0f0f23 0%, #000000 70%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow-x: hidden;
        }

        /* Star field animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(1px 1px at 130px 80px, rgba(255,255,255,0.6), transparent),
                radial-gradient(2px 2px at 160px 30px, #ddd, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: starfield 20s linear infinite;
            z-index: -1;
        }

        @keyframes starfield {
            from { transform: translateY(0); }
            to { transform: translateY(-100px); }
        }

        .container {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.95), rgba(30, 41, 59, 0.9));
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 40px rgba(59, 130, 246, 0.1);
            max-width: 650px;
            width: 90%;
            text-align: center;
            position: relative;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06d6a0, #ffd60a, #3b82f6);
            background-size: 300% 100%;
            animation: lightsaber 3s ease infinite;
        }

        @keyframes lightsaber {
            0% { background-position: 0% 0%; }
            50% { background-position: 100% 0%; }
            100% { background-position: 0% 0%; }
        }

        .logo {
            font-size: 3.2rem;
            font-weight: 900;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 50%, #06d6a0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            letter-spacing: 2px;
            text-transform: uppercase;
            position: relative;
        }

        .logo::before {
            content: "‚ö°";
            font-size: 3.5rem;
            filter: drop-shadow(0 0 10px #3b82f6);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 10px #3b82f6); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 20px #8b5cf6); }
        }

        .subtitle {
            color: #94a3b8;
            margin-bottom: 35px;
            font-size: 1.1rem;
            font-weight: 400;
            line-height: 1.6;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tagline {
            color: #3b82f6;
            font-size: 0.9rem;
            margin-bottom: 30px;
            font-style: italic;
            opacity: 0.8;
        }

        .input-group {
            margin-bottom: 24px;
            text-align: left;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #e2e8f0;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            color: #e2e8f0;
            font-family: 'Orbitron', monospace;
        }

        .input-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 
                0 0 0 4px rgba(59, 130, 246, 0.2),
                0 0 20px rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
        }

        .input-group input::placeholder {
            color: #64748b;
            font-style: italic;
        }

        .download-btn {
            background: linear-gradient(135deg, #1e40af 0%, #7c3aed 50%, #059669 100%);
            color: white;
            border: 2px solid rgba(59, 130, 246, 0.4);
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            margin-top: 25px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-family: 'Orbitron', sans-serif;
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .download-btn:hover::before {
            left: 100%;
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 35px rgba(59, 130, 246, 0.4),
                0 0 30px rgba(139, 92, 246, 0.3);
            border-color: #3b82f6;
        }

        .download-btn:active {
            transform: translateY(-1px);
        }

        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .download-btn:disabled::before {
            display: none;
        }

        .progress-container {
            margin-top: 25px;
            display: none;
        }

        .progress-label {
            text-align: left;
            margin-bottom: 8px;
            font-weight: 700;
            color: #e2e8f0;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-bar {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            height: 14px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }

        .progress-fill {
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06d6a0);
            height: 100%;
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: hyperspace 1.5s infinite;
        }

        @keyframes hyperspace {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .status {
            margin-top: 20px;
            padding: 16px 20px;
            border-radius: 12px;
            font-weight: 600;
            display: none;
            backdrop-filter: blur(10px);
            border: 1px solid;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        .status.success {
            background: rgba(6, 214, 160, 0.1);
            color: #06d6a0;
            border-color: rgba(6, 214, 160, 0.3);
            box-shadow: 0 0 20px rgba(6, 214, 160, 0.2);
        }

        .status.error {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }

        .status.info {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border-color: rgba(59, 130, 246, 0.3);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
        }

        .features {
            margin-top: 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .feature {
            padding: 24px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 16px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            transition: all 0.3s ease;
            text-align: left;
            backdrop-filter: blur(10px);
        }

        .feature:hover {
            transform: translateY(-5px);
            border-color: #3b82f6;
            box-shadow: 
                0 10px 25px rgba(59, 130, 246, 0.2),
                0 0 30px rgba(59, 130, 246, 0.1);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            display: block;
            filter: drop-shadow(0 0 10px currentColor);
        }

        .feature h3 {
            color: #e2e8f0;
            margin-bottom: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .feature p {
            color: #94a3b8;
            line-height: 1.6;
            font-size: 0.9rem;
        }

        .disclaimer {
            margin-top: 35px;
            padding: 20px;
            background: rgba(245, 158, 11, 0.1);
            border-radius: 16px;
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fbbf24;
            font-size: 0.85rem;
            line-height: 1.6;
            backdrop-filter: blur(10px);
        }

        .disclaimer strong {
            color: #f59e0b;
        }

        .download-link {
            display: none;
            margin-top: 25px;
            padding: 20px;
            background: rgba(6, 214, 160, 0.1);
            border-radius: 16px;
            border: 1px solid rgba(6, 214, 160, 0.3);
            backdrop-filter: blur(10px);
        }

        .download-link a {
            color: #06d6a0;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1rem;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Orbitron', sans-serif;
        }

        .download-link a:hover {
            color: #34d399;
            transform: translateX(5px);
            text-shadow: 0 0 10px #06d6a0;
        }

        .tech-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            border: 1px solid rgba(59, 130, 246, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            backdrop-filter: blur(10px);
        }

        /* Legal Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .modal-content {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.98), rgba(30, 41, 59, 0.95));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            max-width: 800px;
            width: 100%;
            margin: 20px auto;
            border: 2px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            padding: 25px;
            border-bottom: 2px solid rgba(59, 130, 246, 0.2);
            text-align: center;
        }

        .modal-header h2 {
            color: #e2e8f0;
            font-size: 1.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 0;
        }

        .modal-body {
            padding: 25px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .legal-text {
            color: #cbd5e1;
            line-height: 1.6;
            font-size: 0.9rem;
        }

        .legal-text h3 {
            color: #f59e0b;
            font-size: 1.3rem;
            margin-bottom: 15px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .legal-text h4 {
            color: #3b82f6;
            font-size: 1rem;
            margin: 20px 0 10px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .legal-text p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .legal-text strong {
            color: #f59e0b;
        }

        .legal-final {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            padding: 15px;
            border-radius: 10px;
            color: #fca5a5;
            font-weight: 600;
            text-align: center !important;
            margin-top: 20px;
        }

        .modal-footer {
            padding: 25px;
            border-top: 2px solid rgba(59, 130, 246, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .agreement-section {
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            color: #cbd5e1;
            font-size: 0.95rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .checkbox-container input[type="checkbox"] {
            display: none;
        }

        .checkmark {
            width: 24px;
            height: 24px;
            border: 2px solid rgba(59, 130, 246, 0.4);
            border-radius: 6px;
            background: rgba(15, 23, 42, 0.8);
            position: relative;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .checkmark::after {
            content: "";
            position: absolute;
            left: 6px;
            top: 2px;
            width: 6px;
            height: 12px;
            border: solid #3b82f6;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .checkbox-container input[type="checkbox"]:checked + .checkmark {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.3);
        }

        .checkbox-container input[type="checkbox"]:checked + .checkmark::after {
            opacity: 1;
        }

        .checkbox-text {
            user-select: none;
        }

        .button-section {
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .decline-btn, .agree-btn {
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 2px solid;
            font-family: 'Orbitron', sans-serif;
            min-width: 180px;
        }

        .decline-btn {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border-color: rgba(239, 68, 68, 0.3);
        }

        .decline-btn:hover:not(:disabled) {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
        }

        .agree-btn {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
            border-color: rgba(16, 185, 129, 0.5);
        }

        .agree-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(16, 185, 129, 0.4);
        }

        .decline-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
        }

        .decline-btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }

        /* Mobile responsiveness for modal */
        @media (max-width: 768px) {
            .modal-content {
                margin: 10px;
                border-radius: 15px;
            }
            
            .modal-header, .modal-body, .modal-footer {
                padding: 20px;
            }
            
            .modal-header h2 {
                font-size: 1.4rem;
            }
            
            .modal-footer {
                flex-direction: column;
                gap: 15px;
            }
            
            .agreement-section, .button-section {
                width: 100%;
            }
            
            .decline-btn, .agree-btn {
                width: 100%;
                padding: 12px 20px;
                min-width: auto;
            }
            
            .checkbox-container {
                font-size: 0.85rem;
                gap: 10px;
            }
            
            .checkmark {
                width: 20px;
                height: 20px;
            }
            
            .checkmark::after {
                left: 5px;
                top: 1px;
                width: 5px;
                height: 10px;
            }
        }

        .force-quote {
            margin-top: 20px;
            font-style: italic;
            color: #64748b;
            font-size: 0.9rem;
            opacity: 0.7;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
                margin: 20px;
                border-radius: 20px;
            }
            
            .logo {
                font-size: 2.5rem;
            }
            
            .logo::before {
                font-size: 2.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .features {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .feature {
                padding: 20px;
            }
            
            .tech-badge {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 20px;
                display: inline-block;
            }
        }

        @media (max-width: 480px) {
            .download-btn {
                padding: 18px 30px;
                font-size: 16px;
            }
            
            .input-group input {
                padding: 14px 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="tech-badge">Galactic Web App</div>
        
        <div class="logo">WaveForce</div>
        <p class="subtitle">Convert YouTube videos to high-quality WAV audio files</p>
        
        <div class="input-group">
            <label for="youtube-url">üé¨ YouTube URL</label>
            <input type="url" id="youtube-url" placeholder="https://www.youtube.com/watch?v=..." />
        </div>
        
        <div class="input-group">
            <label for="filename">üìù Custom Filename (Optional)</label>
            <input type="text" id="filename" placeholder="Leave empty for automatic naming" />
        </div>
        
        <button class="download-btn" onclick="showLegalDisclaimer()">
            ‚ö° Convert to WAV
        </button>
        
        <div class="progress-container" id="progress-container">
            <div class="progress-label" id="progress-label">Processing...</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
        
        <div class="status" id="status"></div>
        
        <div class="download-link" id="download-link">
            <a href="#" download>üì• Download WAV Transmission</a>
        </div>

        <!-- Legal Disclaimer Modal -->
        <div class="modal-overlay" id="legal-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚öñÔ∏è Legal Disclaimer & Terms of Use</h2>
                </div>
                <div class="modal-body">
                    <div class="legal-text">
                        <h3>IMPORTANT LEGAL NOTICE</h3>
                        <p><strong>BY CLICKING "I AGREE" BELOW, YOU ACKNOWLEDGE AND AGREE TO THE FOLLOWING TERMS:</strong></p>
                        
                        <h4>1. SOFTWARE PROVIDED "AS IS"</h4>
                        <p>This software (WaveForce) is provided "AS IS" without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose, and non-infringement.</p>
                        
                        <h4>2. NO LIABILITY</h4>
                        <p>In no event shall the software creator, developer, or distributor be liable for any claim, damages, or other liability, whether in an action of contract, tort, or otherwise, arising from, out of, or in connection with the software or the use or other dealings in the software.</p>
                        
                        <h4>3. COPYRIGHT COMPLIANCE</h4>
                        <p>You acknowledge that you are solely responsible for ensuring that your use of this software complies with all applicable copyright laws and terms of service of third-party platforms including but not limited to YouTube. You warrant that you have the necessary rights or permissions to download and convert the content you submit.</p>
                        
                        <h4>4. PRIVATE USE ONLY</h4>
                        <p>This software is intended for private, personal, non-commercial use only. Any commercial use, redistribution, or public performance of downloaded content is strictly prohibited and is your sole responsibility.</p>
                        
                        <h4>5. INDEMNIFICATION</h4>
                        <p>You agree to indemnify, defend, and hold harmless the software creator from and against any and all claims, damages, obligations, losses, liabilities, costs, and expenses (including attorney's fees) arising from your use of this software or violation of these terms.</p>
                        
                        <h4>6. NO ENDORSEMENT</h4>
                        <p>The software creator does not endorse, encourage, or facilitate copyright infringement or violation of any third-party terms of service.</p>
                        
                        <h4>7. USER RESPONSIBILITY</h4>
                        <p>You acknowledge that you are using this software at your own risk and discretion. You are solely responsible for any consequences resulting from your use of this software, including but not limited to legal action from content owners or platform providers.</p>
                        
                        <h4>8. JURISDICTION</h4>
                        <p>These terms shall be governed by applicable law, and any disputes shall be resolved in the appropriate courts.</p>
                        
                        <p class="legal-final"><strong>BY PROCEEDING, YOU CONFIRM THAT YOU HAVE READ, UNDERSTOOD, AND AGREE TO BE BOUND BY THESE TERMS. IF YOU DO NOT AGREE, DO NOT USE THIS SOFTWARE.</strong></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="agreement-section">
                        <label class="checkbox-container">
                            <input type="checkbox" id="terms-checkbox" onchange="toggleAgreementButton()">
                            <span class="checkmark"></span>
                            <span class="checkbox-text">I have read and understand the terms above</span>
                        </label>
                    </div>
                    <div class="button-section">
                        <button class="decline-btn" id="action-btn" onclick="handleAgreementAction()" disabled>
                            I Decline
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="features">
            <div class="feature">
                <span class="feature-icon">üéØ</span>
                <h3>Premium Quality</h3>
                <p>Convert to uncompressed WAV format with maximum audio fidelity and zero quality loss</p>
            </div>
            <div class="feature">
                <span class="feature-icon">‚ö°</span>
                <h3>Lightning Fast</h3>
                <p>Advanced algorithms ensure quick conversion without compromising audio quality</p>
            </div>
            <div class="feature">
                <span class="feature-icon">üõ°Ô∏è</span>
                <h3>Rebel Alliance</h3>
                <p>Join the galactic resistance against low-quality audio formats and embrace the power of WAV</p>
            </div>
        </div>
        
        <div class="disclaimer">
            <strong>‚ö†Ô∏è Railway Version:</strong> 
            This version runs on Railway with full yt-dlp and ffmpeg support. 
            Videos up to 20 minutes and 100MB are supported. $5 monthly credit applies.
            Please ensure you have permission to download the content.
        </div>
    </div>

    <script>
        let isDownloading = false;
        let termsAccepted = false;

        function showLegalDisclaimer() {
            const modal = document.getElementById('legal-modal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function hideLegalDisclaimer() {
            const modal = document.getElementById('legal-modal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            
            // Reset checkbox and button state when modal is closed
            const checkbox = document.getElementById('terms-checkbox');
            const actionBtn = document.getElementById('action-btn');
            checkbox.checked = false;
            actionBtn.textContent = 'I Decline';
            actionBtn.className = 'decline-btn';
            actionBtn.disabled = true;
        }

        function acceptTermsAndProceed() {
            termsAccepted = true;
            hideLegalDisclaimer();
            downloadAudio();
        }

        function toggleAgreementButton() {
            const checkbox = document.getElementById('terms-checkbox');
            const actionBtn = document.getElementById('action-btn');
            
            if (checkbox.checked) {
                actionBtn.textContent = 'I Agree';
                actionBtn.className = 'agree-btn';
                actionBtn.disabled = false;
            } else {
                actionBtn.textContent = 'I Decline';
                actionBtn.className = 'decline-btn';
                actionBtn.disabled = true;
            }
        }

        function handleAgreementAction() {
            const checkbox = document.getElementById('terms-checkbox');
            
            if (checkbox.checked) {
                // User agreed - proceed with conversion
                acceptTermsAndProceed();
            } else {
                // User declined - do nothing (button should be disabled anyway)
                hideLegalDisclaimer();
            }
        }

        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
        }

        function hideStatus() {
            const status = document.getElementById('status');
            status.style.display = 'none';
        }

        function showProgress(label = 'Initializing WaveForce...') {
            const container = document.getElementById('progress-container');
            const labelEl = document.getElementById('progress-label');
            labelEl.textContent = label;
            container.style.display = 'block';
            animateProgress();
        }

        function hideProgress() {
            const container = document.getElementById('progress-container');
            container.style.display = 'none';
        }

        function updateProgress(width, label) {
            const fill = document.getElementById('progress-fill');
            const labelEl = document.getElementById('progress-label');
            fill.style.width = width + '%';
            if (label) labelEl.textContent = label;
        }

        function animateProgress() {
            const fill = document.getElementById('progress-fill');
            let width = 0;
            const interval = setInterval(() => {
                width += Math.random() * 8 + 2;
                if (width >= 85) {
                    clearInterval(interval);
                    width = 85;
                }
                fill.style.width = width + '%';
            }, 300);
        }

        function completeProgress() {
            const fill = document.getElementById('progress-fill');
            const labelEl = document.getElementById('progress-label');
            fill.style.width = '100%';
            labelEl.textContent = 'WaveForce Complete!';
            setTimeout(() => {
                hideProgress();
            }, 1500);
        }

        function validateYouTubeUrl(url) {
            const regex = /^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/;
            return regex.test(url);
        }

        function sanitizeFilename(filename) {
            return filename.replace(/[^a-zA-Z0-9._-]/g, '_').substring(0, 100);
        }

        function extractVideoId(url) {
            const regex = /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        async function downloadAudio() {
            if (isDownloading) return;

            // Check if terms were accepted
            if (!termsAccepted) {
                showLegalDisclaimer();
                return;
            }

            const urlInput = document.getElementById('youtube-url');
            const filenameInput = document.getElementById('filename');
            const downloadBtn = document.querySelector('.download-btn');
            
            const url = urlInput.value.trim();
            const customFilename = filenameInput.value.trim();

            // Validation
            if (!url) {
                showStatus('Please enter a YouTube transmission URL', 'error');
                urlInput.focus();
                return;
            }

            if (!validateYouTubeUrl(url)) {
                showStatus('Invalid YouTube transmission detected', 'error');
                urlInput.focus();
                return;
            }

            // Start download process
            isDownloading = true;
            downloadBtn.disabled = true;
                            downloadBtn.textContent = 'üîÑ Processing...';
            
            hideStatus();
            showProgress('Initializing...');

            try {
                // Simulate realistic processing steps
                await new Promise(resolve => setTimeout(resolve, 800));
                updateProgress(15, 'Fetching video information...');
                
                await new Promise(resolve => setTimeout(resolve, 1200));
                updateProgress(35, 'Analyzing audio stream...');
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                updateProgress(55, 'Downloading audio...');
                
                await new Promise(resolve => setTimeout(resolve, 1800));
                updateProgress(80, 'Converting to WAV format...');
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                updateProgress(95, 'Finalizing...');
                
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Complete the process
                completeProgress();
                
                // Real implementation with Railway Backend
                const videoId = extractVideoId(url);
                const filename = customFilename || `waveforce_${videoId}`;
                
                const response = await fetch('/api/convert', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        url: url,
                        filename: sanitizeFilename(filename)
                    })
                });
                
                if (response.ok) {
                    // Get the blob directly from response
                    const blob = await response.blob();
                    
                    // Get filename from Content-Disposition header or use default
                    const contentDisposition = response.headers.get('Content-Disposition');
                    let downloadFilename = `${sanitizeFilename(filename)}.wav`;
                    
                    if (contentDisposition) {
                        const filenameMatch = contentDisposition.match(/filename="?([^"]+)"?/);
                        if (filenameMatch) {
                            downloadFilename = filenameMatch[1];
                        }
                    }
                    
                    // Create download link
                    const downloadUrl = window.URL.createObjectURL(blob);
                    
                    const downloadLink = document.getElementById('download-link');
                    const link = downloadLink.querySelector('a');
                    link.href = downloadUrl;
                    link.download = downloadFilename;
                    link.textContent = `üì• Download ${downloadFilename} (${(blob.size / 1024 / 1024).toFixed(1)}MB)`;
                    downloadLink.style.display = 'block';
                    
                    showStatus('‚úÖ WaveForce conversion completed successfully!', 'success');
                } else {
                    const error = await response.json();
                    throw new Error(error.error || 'Conversion failed');
                }
                
            } catch (error) {
                hideProgress();
                showStatus('‚ùå Disturbance in the Force: ' + error.message, 'error');
                console.error('WaveForce error:', error);
            } finally {
                isDownloading = false;
                downloadBtn.disabled = false;
                downloadBtn.textContent = '‚ö° Convert to WAV';
            }
        }

        // Enhanced keyboard support
        function handleKeyPress(e) {
            if (e.key === 'Enter' && !isDownloading) {
                showLegalDisclaimer();
            }
        }

        // Close modal with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                hideLegalDisclaimer();
            }
        });

        // Close modal by clicking overlay
        document.getElementById('legal-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideLegalDisclaimer();
            }
        });

        document.getElementById('youtube-url').addEventListener('keypress', handleKeyPress);
        document.getElementById('filename').addEventListener('keypress', handleKeyPress);

        // Auto-focus and Star Wars themed placeholders
        document.addEventListener('DOMContentLoaded', function() {
            const urlInput = document.getElementById('youtube-url');
            urlInput.focus();
            
            // Add some Star Wars themed examples
            const examples = [
                'https://www.youtube.com/watch?v=_D0ZQPqeJkk',
                'https://youtu.be/HcZ9kQ1h-ZY',
                'https://www.youtube.com/watch?v=1gpXMGit4P8'
            ];
            
            urlInput.addEventListener('focus', function() {
                if (!this.value) {
                    const randomExample = examples[Math.floor(Math.random() * examples.length)];
                    this.placeholder = randomExample;
                }
            });
        });

        // Add some Force-themed visual feedback
        document.querySelector('.download-btn').addEventListener('mousedown', function() {
            this.style.transform = 'translateY(-1px) scale(0.98)';
        });

        document.querySelector('.download-btn').addEventListener('mouseup', function() {
            if (!this.disabled) {
                this.style.transform = '';
            }
        });

        // Easter egg: Konami code for extra Force
        let konamiCode = [];
        const konami = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
        
        document.addEventListener('keydown', function(e) {
            konamiCode.push(e.keyCode);
            if (konamiCode.length > 10) {
                konamiCode.shift();
            }
            
            if (konamiCode.toString() === konami.toString()) {
                showStatus('üåü The Force is exceptionally strong with you! May your conversions be ever powerful.', 'success');
                document.body.style.animation = 'starfield 5s linear infinite';
            }
        });
    </script>
</body>
</html>
